<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chatbot Interface for Academic Grading</title>
    <style>
        /* Basic styling for a clean chat interface */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f6;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }
        .chat-container {
            width: 100%;
            max-width: 700px;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 80vh; /* Adjust height as needed */
            min-height: 400px;
        }
        #chat-messages {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            border-bottom: 1px solid #eee;
            scroll-behavior: smooth;
        }
        .message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 20px;
            max-width: 70%;
            line-height: 1.5;
            word-wrap: break-word;
        }
        .message.user {
            background-color: #e0f7fa; /* Light cyan */
            color: #00796b; /* Dark cyan */
            margin-left: auto;
            border-bottom-right-radius: 5px; /* Slightly different corner */
        }
        .message.bot {
            background-color: #f1f0f0; /* Light gray */
            color: #333; /* Dark gray */
            margin-right: auto;
            border-bottom-left-radius: 5px; /* Slightly different corner */
        }
        .message strong {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
            color: #555;
        }
        .message.user strong {
            color: #004d40; /* Even darker cyan */
        }
        .input-area {
            display: flex;
            padding: 20px;
            background-color: #f9f9f9;
            border-top: 1px solid #eee;
        }
        #user-input {
            flex-grow: 1;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 1em;
            outline: none;
            transition: border-color 0.3s ease;
        }
        #user-input:focus {
            border-color: #007bff; /* Blue focus outline */
        }
        #send-btn {
            background-color: #007bff; /* Primary blue */
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            margin-left: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
            outline: none;
        }
        #send-btn:hover {
            background-color: #0056b3; /* Darker blue on hover */
        }
        #send-btn:disabled {
            background-color: #cccccc; /* Gray when disabled */
            cursor: not-allowed;
        }
        #typing-indicator {
            padding: 10px 20px;
            color: #777;
            font-style: italic;
            text-align: center;
            display: none; /* Hidden by default */
            border-top: 1px solid #eee;
            background-color: #f9f9f9;
        }
        /* MIT License Footer */
        .license-footer {
            margin-top: 20px;
            font-size: 0.8em;
            color: #888;
            text-align: center;
            padding-bottom: 10px;
            max-width: 700px;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div id="chat-messages">
            <!-- Initial bot message to set context -->
            <div class="message bot">
                <strong>Bot:</strong> Hello! How can I assist you today regarding academic grading?
            </div>
            <!-- Conversation messages will be dynamically added here -->
        </div>
        <div id="typing-indicator">Typing...</div>
        <div class="input-area">
            <input type="text" id="user-input" placeholder="Type your message..." autocomplete="off">
            <button id="send-btn">Send</button>
        </div>
    </div>

    <div class="license-footer">
        MIT License
        <br>
        Copyright (c) 2023 [Your Name/Organization Name]
        <br>
        Permission is hereby granted, free of charge, to any person obtaining a copy
        of this software and associated documentation files (the "Software"), to deal
        in the Software without restriction, including without limitation the rights
        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
        copies of the Software, and to permit persons to whom the Software is
        furnished to do so, subject to the following conditions:
        <br>
        The above copyright notice and this permission notice shall be included in all
        copies or substantial portions of the Software.
        <br>
        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
        SOFTWARE.
    </div>

    <script>
        // Store your Google Gemini API key here.
        // IMPORTANT: Replace 'YOUR_GEMINI_API_KEY' with your actual API key.
        // For production environments, consider more secure ways to manage API keys.
        const GEMINI_API_KEY = 'YOUR_GEMINI_API_KEY'; 

        // DOM element references for UI components
        const userInput = document.querySelector("#user-input");
        const sendBtn = document.querySelector("#send-btn");
        const chatMessages = document.querySelector("#chat-messages");
        const typingIndicator = document.querySelector("#typing-indicator");

        // Array to maintain conversation history for context, formatted for Gemini API.
        // The initial message from the bot is included here to provide starting context.
        const conversationContext = [
            { role: "model", parts: [{ text: "Hello! How can I assist you today regarding academic grading?" }] }
        ];

        /**
         * Appends a message to the chat display area.
         * @param {string} sender - 'user' or 'bot'.
         * @param {string} messageText - The text content of the message.
         */
        function appendMessage(sender, messageText) {
            const messageDiv = document.createElement("div");
            messageDiv.classList.add("message", sender);
            // Display sender name (You/Bot) clearly
            messageDiv.innerHTML = `<strong>${sender === 'user' ? 'You' : 'Bot'}:</strong> ${messageText}`;
            chatMessages.appendChild(messageDiv);
            // Automatically scroll to the bottom to show the latest message
            chatMessages.scrollTop = chatMessages.scrollHeight; 
        }

        /**
         * Handles sending the user's message, interacting with the Gemini API,
         * and displaying the bot's response.
         */
        async function sendMessage() {
            const messageText = userInput.value.trim();
            if (messageText === "") return; // Do not send empty messages

            // Display user message in the chat and add to conversation context
            appendMessage("user", messageText);
            conversationContext.push({ role: "user", parts: [{ text: messageText }] });
            
            userInput.value = ""; // Clear the input field
            sendBtn.disabled = true; // Disable send button to prevent multiple requests
            typingIndicator.style.display = "block"; // Show the typing indicator
            chatMessages.scrollTop = chatMessages.scrollHeight; // Scroll to show indicator if needed

            try {
                // Construct the API request to the Google Gemini Pro model
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
                    method: 'POST', // Use POST method for sending content
                    headers: {
                        'Content-Type': 'application/json' // Specify JSON content type
                    },
                    body: JSON.stringify({
                        // Send the entire conversation context for multi-turn capabilities
                        contents: conversationContext 
                    })
                });

                // Check if the API response was successful
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`API Error: ${response.status} - ${errorData.error.message || response.statusText}`);
                }

                const data = await response.json();
                // Extract the bot's response text from the API payload
                const botResponseText = data.candidates[0]?.content?.parts[0]?.text || "No response received.";

                // Display bot response in the chat and add to conversation context
                appendMessage("bot", botResponseText);
                conversationContext.push({ role: "model", parts: [{ text: botResponseText }] });

            } catch (error) {
                console.error("Error communicating with Gemini API:", error);
                // Display an error message to the user
                appendMessage("bot", `Error: ${error.message}. Please try again or check your API key.`);
            } finally {
                // Always hide the typing indicator and re-enable the send button
                typingIndicator.style.display = "none";
                sendBtn.disabled = false;
                userInput.focus(); // Return focus to the input field for easy continuation
                chatMessages.scrollTop = chatMessages.scrollHeight; // Ensure scrolled to bottom after response
            }
        }

        // Event Listeners for user input and button click
        sendBtn.addEventListener("click", sendMessage);
        userInput.addEventListener("keypress", (event) => {
            if (event.key === "Enter") {
                sendMessage();
            }
        });

        // Set initial focus to the input field when the page loads
        userInput.focus();
    </script>
</body>
</html>